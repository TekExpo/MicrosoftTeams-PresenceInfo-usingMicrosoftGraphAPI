(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{147:function(e,t,n){e.exports=n(349)},349:function(e,t,n){"use strict";n.r(t);var s=n(0),a=n.n(s),i=n(65),r=n.n(i),o=n(13),l=n(14),c=n(20),u=n(19),h=n(10),d=n(21),m=n(34),p=n.n(m),g=n(144),f=n(145),_=n.n(f),y=function(){function e(t){Object(o.a)(this,e),this.client=g.Client.init({debugLogging:!0,authProvider:function(e){e(null,window.hello("aad").getAuthResponse().access_token)}}),this._handleError=this._handleError.bind(this),this.props=t}return Object(l.a)(e,[{key:"getMe",value:function(e){var t=this;this.client.api("/me").select("displayName").get(function(n,s){n?t._handleError(n):e(null,s)})}},{key:"getPeople",value:function(e){var t=this;this.client.api("/me/people").version("beta").filter("personType eq 'Person'").select("displayName,givenName,surname,emailAddresses,userPrincipalName").top(20).get(function(n,s){n&&t._handleError(n),e(n,s?s.value:[])})}},{key:"getProfilePics",value:function(e,t){var n=this;_.a.each(e,function(e,t){n.client.api("users/".concat(e.props.id,"/photo/$value")).header("Cache-Control","no-cache").responseType("blob").get(function(n,s,a){n?t(n):(e.imageUrl=window.URL.createObjectURL(a.xhr.response),e.initialsColor=null,t())})},function(e){t(e)})}},{key:"searchForPeople",value:function(e,t){var n=this;this.client.api("/users").filter("startswith(displayName,'".concat(e,"')")).select("displayName,givenName,surname,mail,userPrincipalName,id").top(20).get(function(e,s){e&&n._handleError(e),t(e,s?s.value:[])})}},{key:"sendMail",value:function(e,t){var n=this,s={Subject:"Email from the Microsoft Graph Sample with Office UI Fabric",Body:{ContentType:"HTML",Content:'<p>Thanks for trying out Office UI Fabric!</p>\n          <p>See what else you can do with <a href="http://dev.office.com/fabric#/components">\n          Fabric React components</a>.</p>'},ToRecipients:e};this.client.api("/me/sendMail").post({message:s,saveToSentItems:!0},function(e,s,a){e&&n._handleError(e),t(e,a.req._data.message.ToRecipients)})}},{key:"getFiles",value:function(e,t){var n=this;(e?this.client.api(e):this.client.api("/me/drive/root/children").select("name,createdBy,createdDateTime,lastModifiedBy,lastModifiedDateTime,webUrl,file").top(10)).get(function(e,s){e&&n._handleError(e),t(e,s)})}},{key:"getSearch",value:function(e,t){var n=this,s={requests:[{entityTypes:["microsoft.graph.message"],query:{query_string:{query:e}},from:0,size:5,enableTopresults:!0}]};this.client.api("/search/query").version("beta").post(s,function(e,s){e&&n._handleError(e),t(e,s)})}},{key:"getPresence",value:function(e,t){var n=this,s={ids:e};this.client.api("/communications/getPresencesByUserId").version("beta").post(s,function(e,s){e&&n._handleError(e),t(e,s)})}},{key:"_handleError",value:function(e){console.log(e.code+" - "+e.message),401===e.statusCode&&"Access token has expired."===e.message&&this.props.login()}}]),e}(),v=n(146),b=n(66),k=n(25),P=n(27),E=n(26),S=n(11),L=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this)))._peopleList=null,e._searchResults=[],e.sdkHelper=window.sdkHelper,e._showError=e._showError.bind(Object(h.a)(e)),e.state={selectedPeople:[],isLoadingPeople:!0,isLoadingPics:!0},e}return Object(d.a)(t,e),Object(l.a)(t,[{key:"_mapUsersToPersonas",value:function(e,t){return e.map(function(e){var n=t?e.mail:e.emailAddresses[0].address,s=new k.Persona;return s.primaryText=e.displayName,s.secondaryText=n||e.userPrincipalName,s.presence=k.PersonaPresence.none,s.imageInitials=e.givenName&&e.surname?e.givenName.substring(0,1)+e.surname.substring(0,1):e.displayName.substring(0,1),s.initialsColor=Math.floor(15*Math.random())+0,s.props={id:e.id},s})}},{key:"_getPics",value:function(e){var t=this;this.setState({isLoadingPeople:!1}),this.sdkHelper.getProfilePics(e,function(e){t.setState({isLoadingPics:!1})})}},{key:"_sendMailToSelectedPeople",value:function(){var e=this,t=this.state.selectedPeople.map(function(e){return{EmailAddress:{Address:e.secondaryText}}});this.sdkHelper.sendMail(t,function(t,n){t?e._showError(t):e.setState({result:{type:S.MessageBarType.success,text:"Mail sent to ".concat(n.length," recipient(s).")}})})}},{key:"_onFilterChanged",value:function(e,t){var n=this;return this._peopleList?e?this._peopleList.concat(this._searchResults).filter(function(t){return 0===t.primaryText.toLowerCase().indexOf(e.toLowerCase())}).filter(function(e){return!n._listContainsPersona(e,t)}):[]:new Promise(function(e,t){return n.sdkHelper.getPeople(function(t,s){t||(n._peopleList=n._mapUsersToPersonas(s,!1),n._getPics(n._peopleList),e(n._peopleList))})}).then(function(s){return s.concat(n._searchResults).filter(function(t){return 0===t.primaryText.toLowerCase().indexOf(e.toLowerCase())}).filter(function(e){return!n._listContainsPersona(e,t)})})}},{key:"_listContainsPersona",value:function(e,t){return!(!t||!t.length||0===t.length)&&t.filter(function(t){return t.primaryText===e.primaryText}).length>0}},{key:"_onGetMoreResults",value:function(e){var t=this;return this.setState({isLoadingPeople:!0,isLoadingPics:!0}),new Promise(function(n){t.sdkHelper.searchForPeople(e.toLowerCase(),function(e,s){e||(t._searchResults=t._mapUsersToPersonas(s,!0),t.setState({isLoadingPeople:!1}),t._getPics(t._searchResults),n(t._searchResults))})})}},{key:"_onSelectionChanged",value:function(e){this.setState({result:null,selectedPeople:e})}},{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("h3",null,"People Picker example"),a.a.createElement(E.Label,null,a.a.createElement("b",null,"Search"),"."),a.a.createElement(b.NormalPeoplePicker,{onResolveSuggestions:this._onFilterChanged.bind(this),pickerSuggestionsProps:{suggestionsHeaderText:"Suggested People",noResultsFoundText:"No results found",searchForMoreText:"Search",loadingText:"Loading...",isLoading:this.state.isLoadingPics},getTextFromItem:function(e){return e.primaryText},onChange:this._onSelectionChanged.bind(this),onGetMoreResults:this._onGetMoreResults.bind(this),className:"ms-PeoplePicker",key:"normal-people-picker"}),a.a.createElement("br",null),a.a.createElement(P.Button,{buttonType:0,onClick:this._sendMailToSelectedPeople.bind(this),disabled:!this.state.selectedPeople.length>0},"Send mail"),a.a.createElement("br",null),a.a.createElement("br",null),this.state.result&&a.a.createElement(S.MessageBar,{messageBarType:this.state.result.type},this.state.result.text))}},{key:"_showPeopleResults",value:function(){var e="Query loading. Please try again.";this.state.isLoadingPeople||(e=this._peopleList.map(function(e){return"\n".concat(e.primaryText)}).toString());alert(e)}},{key:"_showError",value:function(e){this.setState({result:{type:S.MessageBarType.error,text:"Error ".concat(e.statusCode,": ").concat(e.code," - ").concat(e.message)}})}}]),t}(s.Component),C=n(33),x=n(52),w=n(67),T=n(53),M=n(32),O=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this)))._items=[],e._selection=new C.Selection,e._selection._onSelectionChanged=function(){return e.setState({selectionDetails:e._getSelectionDetails()})},e.sdkHelper=window.sdkHelper,e.state={items:e._items,selectionDetails:e._getSelectionDetails(),isLoading:!1,nextPageToken:null},e._showError=e._showError.bind(Object(h.a)(e)),e}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=this;this.sdkHelper.getFiles(null,function(t,n){e._processItems(t,n)})}},{key:"_processItems",value:function(e,t){if(e)this._showError(e);else{var n=null,s=t.value.map(function(e){return{Name:e.name,Type:e.file?"File":"Folder",Created:new Date(e.createdDateTime).toLocaleDateString(),LastModified:new Date(e.lastModifiedDateTime).toLocaleString(),WebUrl:e.webUrl}});t["@odata.nextLink"]&&(n=t["@odata.nextLink"],s.push(null)),this._items=this._items.filter(function(e){return null!==e}).concat(s),this.setState({items:this._items,isLoading:!!n,nextPageToken:n})}}},{key:"_onRenderItemColumn",value:function(e,t,n){return"WebUrl"===n.key?a.a.createElement(x.Link,{"data-selection-invoke":!0},e[n.key]):e[n.key]}},{key:"_getSelectionDetails",value:function(){var e=this._selection.getSelectedCount();switch(e){case 0:return"No items selected";case 1:return"1 item selected: "+this._selection.getSelection()[0].Name;default:return"".concat(e," items selected")}}},{key:"_onFilterChanged",value:function(e){this._selection.setItems([],!0),this.setState({items:e?this._items.filter(function(t){return t.Name.toLowerCase().indexOf(e.toLowerCase())>-1}):this._items})}},{key:"_onLoadNextPage",value:function(){var e=this,t=this.state.nextPageToken;this.sdkHelper.getFiles(t,function(t,n){e._processItems(t,n)})}},{key:"render",value:function(){var e=this;return a.a.createElement("div",null,a.a.createElement("h3",null,"Details List example"),a.a.createElement(E.Label,null,"Current selection:"),a.a.createElement("p",null,a.a.createElement("i",null,this.state.selectionDetails)),a.a.createElement("br",null),a.a.createElement(w.TextField,{label:"Filter by name:",onChanged:this._onFilterChanged.bind(this)}),a.a.createElement(T.MarqueeSelection,{selection:this._selection},a.a.createElement(C.DetailsList,{items:this.state.items,setKey:"set",selection:this._selection,onItemInvoked:function(e){return window.open(e.WebUrl)},onRenderItemColumn:this._onRenderItemColumn.bind(this),onRenderMissingItem:function(){return e._onLoadNextPage()}}),this.state.isLoading&&a.a.createElement("div",null,a.a.createElement("br",null),a.a.createElement(M.Spinner,{className:"loadingSpinner",label:"Loading..."}),a.a.createElement("br",null))),a.a.createElement("br",null),this.state.error&&a.a.createElement(S.MessageBar,{messageBarType:this.state.error.type},this.state.error.text))}},{key:"_showError",value:function(e){this.setState({error:{type:S.MessageBarType.error,text:"Error ".concat(e.statusCode,": ").concat(e.code," - ").concat(e.message)}})}}]),t}(s.Component),N=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this)))._items=[],e._selection=new C.Selection,e._selection._onSelectionChanged=function(){return e.setState({selectionDetails:e._getSelectionDetails()})},e.sdkHelper=window.sdkHelper,e.state={items:e._items,selectionDetails:e._getSelectionDetails(),isLoading:!1,nextPageToken:null},e._showError=e._showError.bind(Object(h.a)(e)),e.state={value:""},e.handleChange=e.handleChange.bind(Object(h.a)(e)),e.handleSubmit=e.handleSubmit.bind(Object(h.a)(e)),e}return Object(d.a)(t,e),Object(l.a)(t,[{key:"handleChange",value:function(e){this.setState({value:e.target.value})}},{key:"handleSubmit",value:function(e){this._onSearchTextChanged(this.state.value),e.preventDefault()}},{key:"componentWillMount",value:function(){}},{key:"_processItems",value:function(e,t){if(e)this._showError(e);else{var n=null,s=t.value[0].hitsContainers[0].hits.map(function(e,t){return{Name:e._source.sender.emailAddress.name,Email:e._source.sender.emailAddress.address,inferenceClassification:e._source.inferenceClassification,Subject:e._source.subject,sentDateTime:new Date(e._source.sentDateTime).toLocaleDateString(),WebUrl:e._source.webLink,Summary:e._source.bodyPreview}});t["@odata.nextLink"]&&(n=t["@odata.nextLink"],s.push(null)),this._items=this._items.filter(function(e){return null!==e}).concat(s),this.setState({items:this._items,isLoading:!!n,nextPageToken:n})}}},{key:"_onRenderItemColumn",value:function(e,t,n){return"WebUrl"===n.key?a.a.createElement(x.Link,{"data-selection-invoke":!0},e[n.key]):e[n.key]}},{key:"_getSelectionDetails",value:function(){var e=this._selection.getSelectedCount();switch(e){case 0:return"No items selected";case 1:return"1 item selected: "+this._selection.getSelection()[0].Name;default:return"".concat(e," items selected")}}},{key:"_onSearchTextChanged",value:function(e){var t=this;this.sdkHelper.getSearch(e,function(e,n){t._processItems(e,n)})}},{key:"_onFilterChanged",value:function(e){this._selection.setItems([],!0),this.setState({items:e?this._items.filter(function(t){return t.Name.toLowerCase().indexOf(e.toLowerCase())>-1}):this._items})}},{key:"_onLoadNextPage",value:function(){var e=this,t=this.state.nextPageToken;this.sdkHelper.getSearch(t,function(t,n){e._processItems(t,n)})}},{key:"render",value:function(){var e=this;return a.a.createElement("div",null,a.a.createElement("h3",null,"Microsoft Search endpoint"),a.a.createElement(E.Label,null,"Current selection:"),a.a.createElement("p",null,a.a.createElement("i",null,this.state.selectionDetails)),a.a.createElement("input",{type:"text",value:this.state.value,onChange:this.handleChange}),a.a.createElement("input",{type:"button",value:"Search",onClick:this.handleSubmit}),a.a.createElement(w.TextField,{label:"Filter by name:",onChanged:this._onFilterChanged.bind(this)}),a.a.createElement(T.MarqueeSelection,{selection:this._selection},a.a.createElement(C.DetailsList,{items:this.state.items,setKey:"set",selection:this._selection,onItemInvoked:function(e){return window.open(e.WebUrl)},onRenderItemColumn:this._onRenderItemColumn.bind(this),onRenderMissingItem:function(){return e._onLoadNextPage()}}),this.state.isLoading&&a.a.createElement("div",null,a.a.createElement("br",null),a.a.createElement(M.Spinner,{className:"loadingSpinner",label:"Loading..."}),a.a.createElement("br",null))),a.a.createElement("br",null),this.state.error&&a.a.createElement(S.MessageBar,{messageBarType:this.state.error.type},this.state.error.text))}},{key:"_showError",value:function(e){this.setState({error:{type:S.MessageBarType.error,text:"Error ".concat(e.statusCode,": ").concat(e.code," - ").concat(e.message)}})}}]),t}(s.Component),R=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this)))._peopleList=null,e._searchResults=[],e._lstitems=[],e.sdkHelper=window.sdkHelper,e._showError=e._showError.bind(Object(h.a)(e)),e.state={selectedPeople:[],isLoadingPeople:!0,isLoadingPics:!0},e}return Object(d.a)(t,e),Object(l.a)(t,[{key:"_mapUsersToPersonas",value:function(e,t){return e.map(function(e){var n=t?e.mail:e.emailAddresses[0].address,s=new k.Persona;return s.primaryText=e.displayName,s.secondaryText=n||e.userPrincipalName,s.presence=k.PersonaPresence.none,s.imageInitials=e.givenName&&e.surname?e.givenName.substring(0,1)+e.surname.substring(0,1):e.displayName.substring(0,1),s.initialsColor=Math.floor(15*Math.random())+0,s.props={id:e.id},s})}},{key:"_getPics",value:function(e){var t=this;this.setState({isLoadingPeople:!1}),this.sdkHelper.getProfilePics(e,function(e){t.setState({isLoadingPics:!1})})}},{key:"_getPresenceOfSelectedPeople",value:function(){var e=this,t=this.state.selectedPeople.map(function(e){return e.props.id});this.sdkHelper.getPresence(t,function(n,s){e._processItems(n,s,t)})}},{key:"_processItems",value:function(e,t,n){if(e)this._showError(e);else{var s=t.value.map(function(e){return{Id:e.id,Status:e.activity,Availability:e.availability}});this._lstitems=this._lstitems.concat(s),this.setState({listItems:this._lstitems,isLoading:!1,nextPageToken:null})}}},{key:"_onFilterChanged",value:function(e,t){var n=this;return this._peopleList?e?this._peopleList.concat(this._searchResults).filter(function(t){return 0===t.primaryText.toLowerCase().indexOf(e.toLowerCase())}).filter(function(e){return!n._listContainsPersona(e,t)}):[]:new Promise(function(e,t){return n.sdkHelper.getPeople(function(t,s){t||(n._peopleList=n._mapUsersToPersonas(s,!1),n._getPics(n._peopleList),e(n._peopleList))})}).then(function(s){return s.concat(n._searchResults).filter(function(t){return 0===t.primaryText.toLowerCase().indexOf(e.toLowerCase())}).filter(function(e){return!n._listContainsPersona(e,t)})})}},{key:"_listContainsPersona",value:function(e,t){return!(!t||!t.length||0===t.length)&&t.filter(function(t){return t.primaryText===e.primaryText}).length>0}},{key:"_onGetMoreResults",value:function(e){var t=this;return this.setState({isLoadingPeople:!0,isLoadingPics:!0}),new Promise(function(n){t.sdkHelper.searchForPeople(e.toLowerCase(),function(e,s){e||(t._searchResults=t._mapUsersToPersonas(s,!0),t.setState({isLoadingPeople:!1}),t._getPics(t._searchResults),n(t._searchResults))})})}},{key:"_onSelectionChanged",value:function(e){this.setState({result:null,selectedPeople:e})}},{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("h3",null,"User Presence example"),a.a.createElement(E.Label,null,a.a.createElement("b",null,"Search"),"."),a.a.createElement(b.NormalPeoplePicker,{onResolveSuggestions:this._onFilterChanged.bind(this),pickerSuggestionsProps:{suggestionsHeaderText:"Suggested People",noResultsFoundText:"No results found",searchForMoreText:"Search",loadingText:"Loading...",isLoading:this.state.isLoadingPics},getTextFromItem:function(e){return e.primaryText},onChange:this._onSelectionChanged.bind(this),onGetMoreResults:this._onGetMoreResults.bind(this),className:"ms-PeoplePicker",key:"normal-people-picker"}),a.a.createElement("br",null),a.a.createElement(P.Button,{buttonType:0,onClick:this._getPresenceOfSelectedPeople.bind(this),disabled:!this.state.selectedPeople.length>0},"Get Presence"),a.a.createElement("br",null),this.state.result&&a.a.createElement(S.MessageBar,{messageBarType:this.state.result.type},this.state.result.text))}},{key:"_showPeopleResults",value:function(){var e="Query loading. Please try again.";this.state.isLoadingPeople||(e=this._peopleList.map(function(e){return"\n".concat(e.primaryText)}).toString());alert(e)}},{key:"_showError",value:function(e){this.setState({result:{type:S.MessageBarType.error,text:"Error ".concat(e.statusCode,": ").concat(e.code," - ").concat(e.message)}})}}]),t}(s.Component);window.hello=p.a;var j=function(e){function t(e){var n;return Object(o.a)(this,t),n=Object(c.a)(this,Object(u.a)(t).call(this,e)),p.a.init({aad:{name:"Azure Active Directory",oauth:{version:2,auth:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize"},form:!1}}),n.sdkHelper=new y({login:n.login.bind(Object(h.a)(n))}),window.sdkHelper=n.sdkHelper,n.state={isAuthenticated:!!p()("aad").getAuthResponse(),example:""},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=this;this.state.isAuthenticated&&this.sdkHelper.getMe(function(t,n){t||e.setState({displayName:"Hello ".concat(n.displayName,"!")})})}},{key:"login",value:function(){p.a.init({aad:"bed32ab0-835b-469b-bc9f-8e7d628b0160"},{redirect_uri:"http://localhost:3000/",scope:"user.readbasic.all+mail.send+files.read"}),p.a.login("aad",{display:"page",state:"abcd"})}},{key:"logout",value:function(){p()("aad").logout(),this.setState({isAuthenticated:!1,example:"",displayName:""})}},{key:"render",value:function(){var e=this;return a.a.createElement("div",null,a.a.createElement("div",null,a.a.createElement(v.CommandBar,{items:[{key:"component-example-menu",name:"Choose component",disabled:!this.state.isAuthenticated,ariaLabel:"Choose a component example to render in the page",items:[{key:"presence-example",name:"Presence",onClick:function(){e.setState({example:"presence-example"})}}]}],farItems:[{key:"display-name",name:this.state.displayName},{key:"log-in-out=button",name:this.state.isAuthenticated?"Sign out":"Sign in",onClick:this.state.isAuthenticated?this.logout.bind(this):this.login.bind(this)}]})),a.a.createElement("div",{className:"ms-font-m"},a.a.createElement("div",null,a.a.createElement("h2",null,"Demo - Using Microsoft Graph"),(!this.state.isAuthenticated||""===this.state.example)&&a.a.createElement("div",null,a.a.createElement("p",null,"Use Microsoft Graph data in React components."))),a.a.createElement("br",null),this.state.isAuthenticated&&a.a.createElement("div",null,"people-picker-example"===this.state.example&&a.a.createElement(L,null),"details-list-example"===this.state.example&&a.a.createElement(O,null),"search-example"===this.state.example&&a.a.createElement(N,null),"presence-example"===this.state.example&&a.a.createElement(R,null)),a.a.createElement("br",null)))}}]),t}(s.Component);r.a.render(a.a.createElement(j,null),document.getElementById("root"))}},[[147,1,2]]]);
//# sourceMappingURL=main.e1ba5df6.chunk.js.map